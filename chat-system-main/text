<html lang="en" dir="ltr"><head>
  <meta charset="utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
  <script src="basic.js"></script>
  <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
  <link rel="stylesheet" href="boolzapp.css">
  <title>Chat system</title>
<style type="text/css">@font-face { font-family: Roboto; src: url("chrome-extension://mcgbeeipkmelnpldkobichboakdfaeon/css/Roboto-Regular.ttf"); }</style></head>

<body>
  <header>
    <div class="header_left">
      <img src="img/user.png" alt="profile">
      <div class="icons_left">
        <i class="fas fa-circle-notch"></i>
        <i class="fas fa-comment-alt"></i>
        <i class="fas fa-ellipsis-v"></i>
      </div>
    </div>

    <div class="header_right">
      <img src="img/user.png" alt="openchat">
      <div class="name">
        <h4 class="firstname" id="S100">hema</h4>
        <small>Last seen today at <span class="message_time">18:30</span></small>
      </div>
      <div class="icons_right">
        <i class="fas fa-search"></i>
        <i class="fas fa-paperclip"></i>
        <i class="fas fa-ellipsis-v"></i>
      </div>
    </div>
  </header>

  <section>
    <div class="container_left">
      <div class="search_bar">
        <i class="fas fa-search"></i>
        <input class="searchme" type="text" placeholder="Search or start new chat">
      </div>
      <div class="chat_list" id="chat_list">

        <!-- <div class="contact active" data-chat="0">
          <img src="img/user.png" alt="openchat">
          <div class="name">
            <h4 class="firstname">Socrates</h4><small class="message_time">06:35</small><br>
            <small class="sentence">True knowledge exists in knowing that you know nothing</small>
          </div>
        </div> -->



      <div class="contact active" data-chat="0" id="S100"><img src="img/user.png" alt="openchat"><div class="name" }=""><h4 class="firstname" }="">hema</h4><small class="message_time" }="">2023-03-29 </small><br><small class="sentence" }="">last_msg(hema-&gt;rekha)</small></div></div><div class="contact" data-chat="1" id="S101"><img src="img/user.png" alt="openchat"><div class="name" }=""><h4 class="firstname" }="">sushma</h4><small class="message_time" }="">2023-03-29 </small><br><small class="sentence" }="">last_msg(hema-&gt;jaya)</small></div></div></div>
    </div>

    <div class="container_right">
      <div class="message_container">
        <!-- <div class="message_box " data-chat="0">
          <div class="message white">
            <p>data-chat="0"</p>
            <h6>05:15</h6><i class="fas fa-chevron-down"></i>
            <div class="message_dropdown">
              <div class="message_options">
                <div class="message_info">Info</div>
                <div class="message_delete">Delete</div>
              </div>
            </div>
          </div>

          <div class="message green">
            <p>Imagination is moredata-chat="0"</p>
            <h6>05:30</h6><i class="fas fa-chevron-down"></i>
            <div class="message_dropdown">
              <div class="message_options">
                <div class="message_info">Info</div>
                <div class="message_delete">Delete</div>
              </div>
            </div>
          </div>
        </div> -->

       <div class="show" data-chat="0">    
                <div class="message green">
                  <p>this is msg from hema(sender)</p>
                  <h6>for counter :0</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha</p>
                  <h6>for counter :1</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha msg3</p>
                  <h6>for counter :2</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>hey</p>
                  <h6>for counter :3</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>huu</p>
                  <h6>for counter :4</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>d</p>
                  <h6>for counter :5</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :6</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :7</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
              </div> <div class="show" data-chat="0">    
                <div class="message green">
                  <p>this is msg from hema(sender)</p>
                  <h6>for counter :0</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha</p>
                  <h6>for counter :1</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha msg3</p>
                  <h6>for counter :2</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>hey</p>
                  <h6>for counter :3</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>huu</p>
                  <h6>for counter :4</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>d</p>
                  <h6>for counter :5</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :6</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :7</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
              </div> <div class="show" data-chat="0">    
                <div class="message green">
                  <p>this is msg from hema(sender)</p>
                  <h6>for counter :0</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha</p>
                  <h6>for counter :1</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha msg3</p>
                  <h6>for counter :2</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>hey</p>
                  <h6>for counter :3</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>huu</p>
                  <h6>for counter :4</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>d</p>
                  <h6>for counter :5</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :6</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :7</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
              </div> <div class="show" data-chat="0">    
                <div class="message green">
                  <p>this is msg from hema(sender)</p>
                  <h6>for counter :0</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha</p>
                  <h6>for counter :1</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha msg3</p>
                  <h6>for counter :2</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>hey</p>
                  <h6>for counter :3</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>huu</p>
                  <h6>for counter :4</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>d</p>
                  <h6>for counter :5</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :6</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :7</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
              </div> <div class="show" data-chat="0">    
                <div class="message green">
                  <p>this is msg from hema(sender)</p>
                  <h6>for counter :0</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha</p>
                  <h6>for counter :1</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha msg3</p>
                  <h6>for counter :2</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>hey</p>
                  <h6>for counter :3</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>huu</p>
                  <h6>for counter :4</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>d</p>
                  <h6>for counter :5</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :6</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :7</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
              </div> <div class="message_box active" data-chat="0">    
                <div class="message green">
                  <p>this is msg from hema(sender)</p>
                  <h6>for counter :0</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha</p>
                  <h6>for counter :1</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message white">
                  <p>this is msg from rekha msg3</p>
                  <h6>for counter :2</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>hey</p>
                  <h6>for counter :3</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>huu</p>
                  <h6>for counter :4</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>d</p>
                  <h6>for counter :5</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :6</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
                
                <div class="message green">
                  <p>ss</p>
                  <h6>for counter :7</h6><i class="fas fa-chevron-down"></i>
                  <div class="message_dropdown">
                    <div class="message_options">
                      <div class="message_info">Info</div>
                      <div class="message_delete">Delete</div>
                    </div>
                  </div>
                  </div>
              </div></div>

      <footer>
        <div class="type_message">
          <i class="fas fa-smile"></i>
          <input class="type_here" type="text" placeholder="Type a message">
          <i class="fas fa-paper-plane"></i>
          <i class="fas fa-microphone"></i>
        </div>
      </footer>
    </div>
  </section>

  <div class="template">
    <div class="message green">
      <p class="content">Something new</p>
      <h6 class="message_time">5:55</h6><i class="fas fa-chevron-down"></i>
      <div class="message_dropdown">
        <div class="message_options">
          <div class="message_info">Info</div>
          <div class="message_delete">Delete</div>
        </div>
      </div>
    </div>
  </div>

  <script src="boolzapp.js" charset="utf-8"></script>
  <script>
    $(document).ready(function() {
      all_chats();

    });

    /**
     * find the nearest div and session_id stores its ID 
     */
    $('.chat_list').on('click', '.contact', function(e) {
      var session_id = $(this).closest('div').attr('id');
      // $(this).closest('.messgae').addClass("active");
      var data_chat = $(this).closest('div').attr('data-chat'); // document.getElementById("myH1").getAttribute("class");
      // console.log('div data_chat');
      // console.log(data_chat);
      // console.log('div data_chat');

      var currently_active = document.getElementsByClassName("active");
      if (currently_active.length > 0) {
        currently_active[0].className = currently_active[0].className.replace(" active", "");
      }
      this.className += " active";


      open_chat(session_id, data_chat);

   
    
      setInterval(function() {
        hue(session_id, data_chat);

     $(".message_box:first").attr("class", "show");
     $(".message_box:not(.show)").css("display", "none");

      //   var currently_active = document.getElementsByClassName("active");
      // if (currently_active.length > 1) {
      //   $(".message_box").hide();
      // }
        console.log("i have no idea how");
      }, 3000);

    });

    // setTimeout(function(){ location.reload();    console.log("i have no idea how"); }, 5000);
    //   setTimeout(function(){ 

    //  }, 1000);
  </script>


<script>
		function returnCommentSymbol(language = "javascript") {
			const languageObject = {
				bat: "@REM",
				c: "//",
				csharp: "//",
				cpp: "//",
				closure: ";;",
				coffeescript: "#",
				dockercompose: "#",
				css: "/*DELIMITER*/",
				"cuda-cpp": "//",
				dart: "//",
				diff: "#",
				dockerfile: "#",
				fsharp: "//",
				"git-commit": "//",
				"git-rebase": "#",
				go: "//",
				groovy: "//",
				handlebars: "{{!--DELIMITER--}}",
				hlsl: "//",
				html: "<!--DELIMITER-->",
				ignore: "#",
				ini: ";",
				java: "//",
				javascript: "//",
				javascriptreact: "//",
				json: "//",
				jsonc: "//",
				julia: "#",
				latex: "%",
				less: "//",
				lua: "--",
				makefile: "#",
				markdown: "<!--DELIMITER-->",
				"objective-c": "//",
				"objective-cpp": "//",
				perl: "#",
				perl6: "#",
				php: "<!--DELIMITER-->",
				powershell: "#",
				properties: ";",
				jade: "//-",
				python: "#",
				r: "#",
				razor: "<!--DELIMITER-->",
				restructuredtext: "..",
				ruby: "#",
				rust: "//",
				scss: "//",
				shaderlab: "//",
				shellscript: "#",
				sql: "--",
				svg: "<!--DELIMITER-->",
				swift: "//",
				tex: "%",
				typescript: "//",
				typescriptreact: "//",
				vb: "'",
				xml: "<!--DELIMITER-->",
				xsl: "<!--DELIMITER-->",
				yaml: "#"
			}
			return languageObject[language].split("DELIMITER")
		}
		var savedChPos = 0
		var returnedSuggestion = ''
		let editor, doc, cursor, line, pos
		pos = {line: 0, ch: 0}
		var suggestionsStatus = false
		var docLang = "python"
		var suggestionDisplayed = false
		var isReturningSuggestion = false
		document.addEventListener("keydown", (event) => {
		setTimeout(()=>{
			editor = event.target.closest('.CodeMirror');
			if (editor){
				const codeEditor = editor.CodeMirror
				if(!editor.classList.contains("added-tab-function")){
					editor.classList.add("added-tab-function")
					codeEditor.removeKeyMap("Tab")
					codeEditor.setOption("extraKeys", {Tab: (cm)=>{

						if(returnedSuggestion){
							acceptTab(returnedSuggestion)
						}
						else{
							cm.execCommand("defaultTab")
						}
					}})
				}
				doc = editor.CodeMirror.getDoc()
				cursor = doc.getCursor()
				line = doc.getLine(cursor.line)
				pos = {line: cursor.line, ch: line.length}

				if(cursor.ch > 0){
					savedChPos = cursor.ch
				}

				const fileLang = doc.getMode().name
				docLang = fileLang
				const commentSymbol = returnCommentSymbol(fileLang)
				if (event.key == "?"){
					var lastLine = line
					lastLine = lastLine.slice(0, savedChPos - 1)

					if(lastLine.trim().startsWith(commentSymbol[0])){
						lastLine += " "+fileLang
						lastLine = lastLine.split(commentSymbol[0])[1]
						window.postMessage({source: 'getQuery', payload: { data: lastLine } } )
						isReturningSuggestion = true
						displayGrey("\nBlackbox loading...")
					}
				}else if(event.key === "Enter" && suggestionsStatus && !isReturningSuggestion){
					var query = doc.getRange({ line: Math.max(0,cursor.line-10), ch: 0 }, { line: cursor.line, ch: line.length })
					window.postMessage({source: 'getSuggestion', payload: { data: query, language: docLang } } )
					displayGrey("Blackbox loading...")
				}else if(event.key === "ArrowRight" && returnedSuggestion){
					acceptTab(returnedSuggestion)
				}else if(event.key === "Enter" && isReturningSuggestion){
					displayGrey("\nBlackbox loading...")
				}else if(event.key === "Escape"){
					displayGrey("")
				}
			}
		}, 0)
		})

		function acceptTab(text){
		if (suggestionDisplayed){
			displayGrey("")
			doc.replaceRange(text, pos)
			returnedSuggestion = ""
			updateSuggestionStatus(false)
		}
		}
		function acceptSuggestion(text){
			displayGrey("")
			doc.replaceRange(text, pos)
			returnedSuggestion = ""
			updateSuggestionStatus(false)
		}
		function displayGrey(text){
			if(!text){
				document.querySelector(".blackbox-suggestion").remove()
				return
			}
			var el = document.querySelector(".blackbox-suggestion")
			if(!el){
				el = document.createElement('span')
				el.classList.add("blackbox-suggestion")
				el.style = 'color:grey'
				el.innerText = text
			}
			else{
				el.innerText = text
			}
			
			var lineIndex = pos.line;
			editor.getElementsByClassName('CodeMirror-line')[lineIndex].appendChild(el)
		}
		function updateSuggestionStatus(s){
			suggestionDisplayed = s
			window.postMessage({source: 'updateSuggestionStatus', status: suggestionDisplayed, suggestion: returnedSuggestion})
		}
		window.addEventListener('message', (event)=>{
		if (event.source !== window ) return
		if (event.data.source == 'return'){
			isReturningSuggestion = false
			const formattedCode = formatCode(event.data.payload.data)
			returnedSuggestion = formattedCode
			displayGrey(formattedCode)
			updateSuggestionStatus(true)
		}
		if(event.data.source == 'suggestReturn'){
			returnedSuggestion = event.data.payload.data
			displayGrey(event.data.payload.data)
			updateSuggestionStatus(true)
		}
		if(event.data.source == 'suggestionsStatus'){
			suggestionsStatus = event.data.payload.enabled
		}
		if(event.data.source == 'acceptSuggestion'){
			
			acceptSuggestion(event.data.suggestion)
		}
		})
		document.addEventListener("keyup", function(){
			returnedSuggestion = ""
			updateSuggestionStatus(false)
		})
		function formatCode(data) {
			if (Array.isArray(data)) {
				var finalCode = ""
				var pairs = []
		
				const commentSymbol = returnCommentSymbol(docLang)
				data.forEach((codeArr, idx) => {
					const code = codeArr[0]
					var desc = codeArr[1]
					const descArr = desc.split("\n")
					var finalDesc = ""
					descArr.forEach((descLine, idx) => {
						const whiteSpace = descLine.search(/\S/)
						if (commentSymbol.length < 2 || idx === 0) {
							finalDesc += insert(descLine, whiteSpace, commentSymbol[0])
						}
						if (commentSymbol.length > 1 && idx === descArr.length - 1) {
							finalDesc = finalDesc + commentSymbol[1] + "\n"
						}
					})
		
					finalCode += finalDesc + "\n\n" + code
					pairs.push(finalCode)
				})
				return "\n"+pairs.join("\n")
			}
		
			return "\n"+data
		}
		
		function insert(str, index, value) {
			return str.substr(0, index) + value + str.substr(index)
		}
	</script></body></html>